---
title: "A7 - Clustering"
author: "Ayushi,Manthan Thakar"
date: "11/1/2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
```

## Clustering  

###Obsevations 

```{r}
OUTPUT_PATH = "output/kmeans-loudness/part-00000"
values = read.csv(OUTPUT_PATH, header = FALSE)
cluster_min = values[values$V1 == 1, ]
cluster_max = values[values$V1 == 0, ]
values$V1 = as.factor(values$V1)
p<- ggplot(values, aes(x=V1, y=V2)) + 
  geom_jitter(aes(col = values$V1))
p+ labs(x = "Cluster",y="Loudness",col = "Cluster")
```
Figure -1  
  
It is observed that the data points belonging to the same loudness range appear in the same cluster in a Loudness vs Cluster graph, validating the fact that the clustering analysis has been exceuted properly. 
```{r}
counts <- table(values$V1)
barplot(counts, main="Distribution", 
  	xlab="Cluster", ylab="No. of data points")
```
Figure-2   

It is observed that maximum number of points are in cluster 0 indicating that most songs are -{quiet,medum,loud} followed by cluster 2{quiet,medium,loud}  
```{r}
d1<-aggregate(values$V2, by=list(Cluster=values$V1), FUN=mean)
d2<-aggregate(values$V2, by=list(Cluster=values$V1), FUN=sd)
d1$sd<-d2$x
colnames(d1)<-c("Cluster","Mean Loudness","Standard Deviation")
library(formattable)
formattable(d1)
```  
Mean loudness of clusters are shown in the above table.Cluster 1 shows maximum standard deviation indicating that the values are spreadout and farther away from the mean. Cluster 0 has minimum standard deviation indicating that values are close to the mean.Both the facts,Mean and Standard deviation, can also be clearly seen in Figure-1.

```{r}
OUTPUT_PATH = "output/kmeans-length/part-00000"
values = read.csv(OUTPUT_PATH, header = FALSE)
cluster_min = values[values$V1 == 1, ]
cluster_max = values[values$V1 == 0, ]
values$V1 = as.factor(values$V1)
p<- ggplot(values, aes(x=V1, y=V2)) + 
  geom_jitter(aes(col = values$V1))
p+ labs(x = "Cluster",y="Length",col = "Cluster")
```

```{r}
OUTPUT_PATH = "output/kmeans-hotness/part-00000"
values = read.csv(OUTPUT_PATH, header = FALSE)
cluster_min = values[values$V1 == 1, ]
cluster_max = values[values$V1 == 0, ]
values$V1 = as.factor(values$V1)
p<- ggplot(values, aes(x=V1, y=V2)) + 
  geom_jitter(aes(col = values$V1))
p+ labs(x = "Cluster",y="Length",col = "Cluster")
```

```{r}
OUTPUT_PATH = "output/kmeans-hotness-random/part-00000"
values = read.csv(OUTPUT_PATH, header = FALSE)
cluster_min = values[values$V1 == 1, ]
cluster_max = values[values$V1 == 0, ]
values$V1 = as.factor(values$V1)
p<- ggplot(values, aes(x=V1, y=V2)) + 
  geom_jitter(aes(col = values$V1))
p+ labs(x = "Cluster",y="Length",col = "Cluster")
```

```{r}
OUTPUT_PATH = "output/combined-hotness/part-00000"
values = read.csv(OUTPUT_PATH, header = FALSE)
values$V1 = as.factor(values$V1)
p<- ggplot(values, aes(x=V2, y=V3)) + 
  geom_jitter(aes(col = values$V1))
p+ labs(x = "Song Hotness",y="Artist Hotness",col = "Cluster")
```